/*
* Overlay v1.3.3 Copyright (c) 2015 AJ Savino
* https://github.com/koga73/Overlay
* MIT LICENSE
*/
var Overlay=function(){var e,t={EVENT_BEFORE_SHOW:"beforeshow",EVENT_AFTER_SHOW:"aftershow",EVENT_BEFORE_HIDE:"beforehide",EVENT_AFTER_HIDE:"afterhide"},n={ID_CONTAINER:"overlayContainer",ID_BACKGROUND:"overlayBackground",ID_FRAME:"overlayFrame",ID_CLOSE:"overlayClose",CLASS_FRAME_VISIBLE:"visible",CLASS_BODY_OVERLAY_VISIBLE:"overlay-visible",CLASS_CONTENT:"overlay-content",ID_FRAME:"overlayFrame",DATA_CONTAINER:"data-overlay-container",DATA_PAGE_WRAP:"data-overlay-page-wrap",DATA_TRIGGER:"data-overlay-trigger",DATA_WIDTH:"data-overlay-width",DATA_HEIGHT:"data-overlay-height",DATA_OFFSET_X:"data-overlay-offset-x",DATA_OFFSET_Y:"data-overlay-offset-y",DATA_CONTAINER_CLASS:"data-overlay-container-class",DATA_USER_CLOSABLE:"data-overlay-user-closable",FOCUSABLE:"a[href],input,select,textarea,button,[tabindex]"},r={container:document.body,pageWrap:null,_container:null,_background:null,_content:null,_frame:null,_close:null,_showCallback:null,_hideCallback:null,_lastFocus:null},a={initialize:function(){var t=document.createElement("div");t.setAttribute("id",n.ID_CONTAINER),r._container=t;var a=document.createElement("div");a.setAttribute("id",n.ID_BACKGROUND),r._background=a;var i=document.createElement("div");i.setAttribute("id",n.ID_FRAME),r._frame=i;var o=document.createElement("button");o.setAttribute("id",n.ID_CLOSE),o.setAttribute("type","button"),o.innerHTML="Close",r._close=o,i.appendChild(o),t.appendChild(a),t.appendChild(i);var t=document.querySelector("["+n.DATA_CONTAINER+"]");t&&(e.container=t);var l=document.querySelector("["+n.DATA_PAGE_WRAP+"]");l&&(e.pageWrap=l);for(var d=document.querySelectorAll("["+n.DATA_TRIGGER+"]"),s=d.length,u=0;s>u;u++)!function(t){var r=d[t],a=r.getAttribute(n.DATA_TRIGGER);a.length||(a=r.getAttribute("href")),"#"==a.substr(0,1)&&(a=a.substr(1,a.length-1)),OOP.addEventListener(r,"click",function(t){return"undefined"!=typeof t.preventDefault?t.preventDefault():t.returnValue=!1,e.show(a),!1})}(u)},destroy:function(){o.removeClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE),OOP.removeEventListener(document,"focusin",a._handler_document_focusin),OOP.removeEventListener(document,"keyup",a._handler_document_keyUp);var e=r._close;e&&(OOP.removeEventListener(e,"click",a._handler_close_click),e.removeAttribute("disabled")),r._close=null,r._frame=null;var t=r._content;t&&(t.parentNode.removeChild(t),"undefined"!=typeof t._overlayData.width&&(t.style.width=""),"undefined"!=typeof t._overlayData.height&&(t.style.height=""),"undefined"!=typeof t._overlayData.parent&&t._overlayData.parent.appendChild(t),t._overlayData=null,t.removeAttribute("tabindex"),o.removeClass(t,n.CLASS_CONTENT)),r._content=null;var i=r._background;i&&OOP.removeEventListener(i,"click",a._handler_background_click),r._background=null;var l=r._container;l&&(l.setAttribute("class",""),l.parentNode&&l.parentNode.removeChild(l)),r._container=null,r._showCallback=null,r._hideCallback=null,r._lastFocus=null;for(var d=document.querySelectorAll("["+n.DATA_TRIGGER+"]"),s=d.length,u=0;s>u;u++){var _=d[u],v=_.getAttribute(n.DATA_TRIGGER);v.length||(v=_.getAttribute("href")),"#"==v.substr(0,1)&&(v=v.substr(1,v.length-1)),OOP.removeEventListener(_,"click")}},show:function(t,l,d){if("undefined"==typeof l&&(l={}),r._showCallback=d,o.addClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_BEFORE_SHOW)),null!=r._content)return void e.hide(function(){e.show(t,l,d)});var s,u,_,v,c=document.getElementById(t),E="",f=!0;if("undefined"!=typeof l.width)s=l.width;else{var h=c.getAttribute(n.DATA_WIDTH);h&&h.length&&(s=h)}if("undefined"!=typeof l.height)u=l.height;else{var p=c.getAttribute(n.DATA_HEIGHT);p&&p.length&&(u=p)}if("undefined"!=typeof l.offsetX)_=l.offsetX;else{var m=c.getAttribute(n.DATA_OFFSET_X);m&&m.length&&(_=m)}if("undefined"!=typeof l.offsetY)v=l.offsetY;else{var y=c.getAttribute(n.DATA_OFFSET_Y);y&&y.length&&(v=y)}if("undefined"!=typeof l.containerClass)E=l.containerClass;else{var A=c.getAttribute(n.DATA_CONTAINER_CLASS);A&&A.length&&(E=A)}if("undefined"!=typeof l.userClosable)f="true"==l.userClosable.toLowerCase();else{var O=c.getAttribute(n.DATA_USER_CLOSABLE);O&&O.length&&(f="true"==O.toLowerCase())}var T=r._container,b=r._background,C=r._frame,g=r._close;o.addClass(c,n.CLASS_CONTENT),c.setAttribute("tabindex","0"),c._overlayData=c._overlayData||{},"undefined"==typeof s&&(s="undefined"!=typeof document.documentElement.currentStyle?c.currentStyle.width:window.getComputedStyle(c).width),parseInt(s)?(C.style.width=s,c._overlayData.width=s,c.style.width="100%"):C.style.width="","undefined"==typeof u&&(u="undefined"!=typeof document.documentElement.currentStyle?c.currentStyle.height:window.getComputedStyle(c).height),parseInt(u)?(C.style.height=u,c._overlayData.height=u,c.style.height="100%"):C.style.height="",C.style.left="undefined"!=typeof _?_:"",C.style.top="undefined"!=typeof v?v:"",r._content=c,OOP.addEventListener(document,"focusin",a._handler_document_focusin),f?(OOP.addEventListener(document,"keyup",a._handler_document_keyUp),OOP.addEventListener(b,"click",a._handler_background_click),OOP.addEventListener(g,"click",a._handler_close_click)):g.setAttribute("disabled","disabled"),c._overlayData.parent=c.parentNode,c.parentNode.removeChild(c),C.insertBefore(c,g);var L=e.container;e.container.length&&(L=e.container[0]),L.appendChild(T),r._lastFocus=document.activeElement;var S=e.pageWrap;if(S){if(S.contains(L))throw"Error: The page wrapper ["+n.DATA_PAGE_WRAP+"] should not contain the modal container. They should be siblings instead.";S.setAttribute("aria-hidden","true"),S.setAttribute("tabindex","-1")}var D=c.querySelector(n.FOCUSABLE);D||(D=c),D.focus(),o.addClass(T,E);var H=setTimeout(function(){clearTimeout(H),o.addClass(T,n.CLASS_FRAME_VISIBLE)},50);i.hasTransition(b)||i.hasTransition(C)?(i.offTransitionComplete(T),i.onTransitionComplete(T,a._handler_show_complete)):a._handler_show_complete()},hide:function(t){r._hideCallback=t,OOP.dispatchEvent(e,new OOP.Event(e.EVENT_BEFORE_HIDE)),OOP.removeEventListener(document,"focusin",a._handler_document_focusin),OOP.removeEventListener(document,"keyup",a._handler_document_keyUp);var l=r._close;l&&(OOP.removeEventListener(l,"click",a._handler_close_click),l.removeAttribute("disabled"));var d=r._background;d&&OOP.removeEventListener(d,"click",a._handler_background_click);var s=r._frame,u=r._container;u&&(i.hasTransition(d)||i.hasTransition(s)?(i.offTransitionComplete(u),i.onTransitionComplete(u,a._handler_hide_complete)):a._handler_hide_complete(),o.removeClass(u,n.CLASS_FRAME_VISIBLE))},_handler_show_complete:function(){i.offTransitionComplete(r._container),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_AFTER_SHOW));var t=r._showCallback;"undefined"!=typeof t&&(t(),r._showCallback=null)},_handler_hide_complete:function(){var t=r._container;i.offTransitionComplete(t);var a=r._content;a&&(a.parentNode.removeChild(a),"undefined"!=typeof a._overlayData.width&&(a.style.width=""),"undefined"!=typeof a._overlayData.height&&(a.style.height=""),"undefined"!=typeof a._overlayData.parent&&a._overlayData.parent.appendChild(a),a._overlayData=null,a.removeAttribute("tabindex"),o.removeClass(a,n.CLASS_CONTENT)),r._content=null,t.setAttribute("class",""),t.parentNode.removeChild(t);var l=e.pageWrap;l&&(l.removeAttribute("aria-hidden","true"),l.removeAttribute("tabindex","-1"));var d=r._lastFocus;d&&d.focus(),r._lastFocus=null,o.removeClass(document.body,n.CLASS_BODY_OVERLAY_VISIBLE),OOP.dispatchEvent(e,new OOP.Event(e.EVENT_AFTER_HIDE));var s=r._hideCallback;"undefined"!=typeof s&&(s(),r._hideCallback=null)},_handler_close_click:function(t){return"undefined"!=typeof t.preventDefault?t.preventDefault():t.returnValue=!1,e.hide(),!1},_handler_background_click:function(t){return"undefined"!=typeof t.preventDefault?t.preventDefault():t.returnValue=!1,e.hide(),!1},_handler_document_keyUp:function(t){27==t.keyCode&&e.hide()},_handler_document_focusin:function(e){var t=e.target||e.srcElement,n=r._frame;if(t!=n&&!n.contains(t)){"undefined"!=typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;var a=r._content;a&&a.focus()}}},i=function(){for(var e=null,t=null,n=[["webkitTransition","webkitTransitionEnd","-webkit-"],["transition","transitionend",""]],r=n.length,a=0;r>a&&"undefined"==typeof document.documentElement.style[n[a][0]];a++);return a!=r&&(e=n[a][1],t=n[a][2]),{hasTransition:function(e){return"undefined"!=typeof document.documentElement.currentStyle?parseFloat(e.currentStyle[t+"transition-duration"])>0:parseFloat(window.getComputedStyle(e)[t+"transition-duration"])>0},onTransitionComplete:function(t,n){e?OOP.addEventListener(t,e,n):n()},offTransitionComplete:function(t,n){e&&("undefined"!=typeof n?OOP.removeEventListener(t,e,n):OOP.removeEventListener(t,e))}}}(),o=function(){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),{addClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");for(var r in t)n.push(t[r].trim());e.setAttribute("class",n.join(" ").trim())},removeClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");for(var r in t)for(var a=n.length,i=0;a>i;i++)n[i]==t[r].trim()&&(n.splice(i,1),a--,i--);e.setAttribute("class",n.join(" ").trim())},hasClass:function(e,t){var n=(e.getAttribute("class")||"").split(" ");t=t.split(" ");var r=0;for(var a in t)for(var i=n.length,o=0;i>o;o++)if(n[o]==t[a].trim()){r++;break}return r==t.length?!0:!1}}}();return e={EVENT_BEFORE_SHOW:t.EVENT_BEFORE_SHOW,EVENT_AFTER_SHOW:t.EVENT_AFTER_SHOW,EVENT_BEFORE_HIDE:t.EVENT_BEFORE_HIDE,EVENT_AFTER_HIDE:t.EVENT_AFTER_HIDE,container:r.container,pageWrap:r.pageWrap,initialize:a.initialize,destroy:a.destroy,hide:a.hide,show:a.show}}();if(!OOP)var OOP=function(){var e={event:function(e,t){var n=null;try{n=new CustomEvent(e)}catch(r){document.createEventObject?(n=document.createEventObject("Event"),n.initCustomEvent&&n.initCustomEvent(e,!0,!0)):n={}}return n._type=e,n._data=t,n},addEventListener:function(t,n,r){t._eventHandlers||(t._eventHandlers={}),n=n.split(",");for(var a=n.length,i=0;a>i;i++){var o=n[i];if(t.addEventListener)r=e._addEventHandler(t,o,r),t.addEventListener(o,r);else if(t.attachEvent){var l=function(){r(window.event)};l.handler=r,l=e._addEventHandler(t,o,l),t.attachEvent("on"+o,l)}else"undefined"!=typeof jQuery?(r=e._addEventHandler(t,o,r),jQuery.on(o,r)):(t.addEventListener=e._addEventListener,t.addEventListener(o,r))}},_addEventListener:function(t,n){n._isCustom=!0,e._addEventHandler(this,t,n)},_addEventHandler:function(e,t,n){e._eventHandlers[t]||(e._eventHandlers[t]=[]);for(var r=e._eventHandlers[t],a=r.length,i=0;a>i;i++){if(r[i]===n)return n;if(r[i].handler&&r[i].handler===n)return r[i]}return r.push(n),n},removeEventListener:function(t,n,r){t._eventHandlers||(t._eventHandlers={}),n=n.split(",");for(var a=n.length,i=0;a>i;i++){var o,l=n[i];o="undefined"==typeof r?t._eventHandlers[l]||[]:[r];for(var d=o.length,s=0;d>s;s++){var r=o[s];t.removeEventListener?(r=e._removeEventHandler(t,l,r),t.removeEventListener(l,r)):t.detachEvent?(r=e._removeEventHandler(t,l,r),t.detachEvent("on"+l,r)):"undefined"!=typeof jQuery?(r=e._removeEventHandler(t,l,r),jQuery.off(l,r)):(t.removeEventListener=e._removeEventListener,t.removeEventListener(l,r))}}},_removeEventListener:function(t,n){t=t.split(",");for(var r=t.length,a=0;r>a;a++){var i,o=t[a];i="undefined"==typeof n?this._eventHandlers[o]||[]:[n];for(var l=i.length,d=0;l>d;d++){var n=i[d];n._isCustom=!1,e._removeEventHandler(this,o,n)}}},_removeEventHandler:function(e,t,n){e._eventHandlers[t]||(e._eventHandlers[t]=[]);for(var r=e._eventHandlers[t],a=r.length,i=0;a>i;i++){if(r[i]===n)return r.splice(i,1)[0];if(r[i].handler&&r[i].handler===n)return r.splice(i,1)[0]}},dispatchEvent:function(t,n){t._eventHandlers||(t._eventHandlers={}),t.dispatchEvent?t.dispatchEvent(n):t.fireEvent?t.fireEvent("on"+type,n):"undefined"!=typeof jQuery?jQuery(t).trigger(jQuery.Event(n._type,{_type:n._type,_data:n._data})):(t.dispatchEvent=e._dispatchEvent,t.dispatchEvent(n))},_dispatchEvent:function(t){e._dispatchEventHandlers(this,t)},_dispatchEventHandlers:function(e,t){var n=e._eventHandlers[t._type];if(n)for(var r=n.length,a=0;r>a;a++)n[a](t)}};return{Event:e.event,addEventListener:e.addEventListener,removeEventListener:e.removeEventListener,dispatchEvent:e.dispatchEvent}}();Overlay.initialize();